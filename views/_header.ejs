  <!doctype html>
  <html lang="en">
    <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>PUTrace</title>
      <link rel="stylesheet" href="/styles.css" />
    </head>
    <body>
      <a class="skip-link" href="#main-content">Skip to main content</a>
      <%
        const path = currentPath || '/';
        const isActive = (href) => path === href || path.startsWith(href + '/');
        const unreadCount = (typeof unreadMessagesCount === 'number' && Number.isFinite(unreadMessagesCount))
          ? unreadMessagesCount
          : 0;
      %>
      <header class="site-header">
        <div class="brand">
          <img src="/putrace_circular_logo.png" alt="PUTrace Logo" class="logo-img" />
          <div>
            <h1>PUTrace</h1>
            <p class="sub">Campus Item Recovery System</p>
          </div>
        </div>
        <nav class="site-nav" aria-label="Primary">
          <a href="/" class="<%= path === '/' ? 'active' : '' %>">Home</a>
          <% if (currentUser) { %>
            <div class="site-nav-group">
              <a href="/dashboard" class="<%= isActive('/dashboard') ? 'active' : '' %>">Dashboard</a>
              <a href="/items/new" class="<%= isActive('/items/new') ? 'active' : '' %>">Register Item</a>
              <a href="/messages" class="<%= isActive('/messages') ? 'active' : '' %>">
                Messages
                <% if (unreadCount > 0) { %>
                  <span class="nav-badge"><%= unreadCount %></span>
                <% } %>
              </a>
            </div>
            <div class="site-nav-group secondary">
              <a href="/account" class="<%= isActive('/account') ? 'active' : '' %>">Account</a>
              <a href="/logout">Logout</a>
            </div>
          <% } else { %>
            <div class="site-nav-group secondary">
              <a href="/login" class="<%= isActive('/login') ? 'active' : '' %>">Login</a>
              <a href="/signup" class="nav-cta">Sign up</a>
            </div>
          <% } %>
        </nav>
      </header>

      <main id="main-content">
        <% if (flash) { %>
          <% if (flash.type === 'success') { %>
            <div id="success-modal" class="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="success-title">
              <div class="modal-box">
                <button type="button" class="modal-close" id="success-modal-close" aria-label="Close confirmation">x</button>
                <h3 id="success-title" class="success-title">Action Completed</h3>
                <p class="success-message"><%= flash.message %></p>
                <div class="success-actions">
                  <button type="button" class="btn-sm" id="success-modal-ok">OK</button>
                </div>
              </div>
            </div>
          <% } else { %>
            <div class="flash <%= flash.type %>"><%= flash.message %></div>
          <% } %>
        <% } %>
